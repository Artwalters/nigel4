<!DOCTYPE html>
<html lang="nl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Coaching Traject - Nigel</title>
    <link rel="stylesheet" href="../styles.css">
</head>
<body>
    <!-- Page Transition -->
    <div class="page-transition">
        <div class="page-transition__orange"></div>
        <div class="page-transition__black"></div>
    </div>

    <!-- Immediate transition check -->
    <script>
        // Check immediately on page load
        if (sessionStorage.getItem('pageTransitionActive')) {
            const frameBlack = document.querySelector('.page-transition__black');
            const frameOrange = document.querySelector('.page-transition__orange');
            if (frameBlack && frameOrange) {
                // Both frames should start at full scale for exit animation
                frameBlack.style.transform = 'scaleY(1)';
                frameBlack.style.transformOrigin = 'bottom';
                frameOrange.style.transform = 'scaleY(1)';
                frameOrange.style.transformOrigin = 'bottom';
            }
        }
    </script>

    <!-- Navigation -->
    <nav class="navbar">
        <div class="nav-container" style="justify-content: flex-end;">
            <a href="../" class="nav-link">Terug</a>
        </div>
    </nav>


    <div class="trajectory-page">
        <div class="trajectory-left">
            <div class="form-container">
                <h2 class="form-title">Start nu</h2>
                <form class="trajectory-form" id="trajectoryForm">
                    <div class="form-group">
                        <label class="form-label" for="name">Volledige naam *</label>
                        <input type="text" class="form-input" id="name" name="name" placeholder="Voor- en achternaam" required>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label" for="email">E-mailadres *</label>
                        <input type="email" class="form-input" id="email" name="email" placeholder="je@email.com" required>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label" for="phone">Telefoonnummer *</label>
                        <input type="tel" class="form-input" id="phone" name="phone" placeholder="+31 6 12345678" required>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label" for="age">Leeftijd *</label>
                        <input type="number" class="form-input" id="age" name="age" min="16" max="80" placeholder="25" required>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label" for="experience">Ervaring met fitness/coaching</label>
                        <select class="form-input" id="experience" name="experience">
                            <option value="">Selecteer je niveau</option>
                            <option value="beginner">Beginner (0-1 jaar)</option>
                            <option value="intermediate">Gevorderd (1-3 jaar)</option>
                            <option value="advanced">Ervaren (3+ jaar)</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label" for="goals">Wat is je hoofddoel? *</label>
                        <select class="form-input" id="goals" name="goals" required>
                            <option value="">Selecteer je doel</option>
                            <option value="weight-loss">Afvallen</option>
                            <option value="muscle-gain">Spieren opbouwen</option>
                            <option value="strength">Sterker worden</option>
                            <option value="health">Gezonder leven</option>
                            <option value="transformation">Complete transformatie</option>
                            <option value="maintenance">Huidige vorm behouden</option>
                            <option value="other">Anders</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label" for="timeframe">Wanneer wil je starten?</label>
                        <select class="form-input" id="timeframe" name="timeframe">
                            <option value="">Selecteer tijdframe</option>
                            <option value="immediate">Direct</option>
                            <option value="week">Binnen een week</option>
                            <option value="month">Binnen een maand</option>
                            <option value="flexible">Ben flexibel</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label" for="challenges">Wat zijn je grootste uitdagingen? *</label>
                        <textarea class="form-textarea" id="challenges" name="challenges" placeholder="Bijvoorbeeld: geen tijd, motivatie, blessures, voeding..." required></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label" for="motivation">Wat motiveert je het meest?</label>
                        <textarea class="form-textarea" id="motivation" name="motivation" placeholder="Waarom wil je deze verandering maken? Wat drijft je?"></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label" for="message">Extra informatie</label>
                        <textarea class="form-textarea" id="message" name="message" placeholder="Vertel ons meer over jezelf, je situatie, of stel een vraag..."></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label" for="contact-preference">Voorkeur voor contact</label>
                        <select class="form-input" id="contact-preference" name="contact-preference">
                            <option value="email">E-mail</option>
                            <option value="phone">Telefonisch</option>
                            <option value="whatsapp">WhatsApp</option>
                        </select>
                    </div>
                    
                    <input type="hidden" id="selectedPlan" name="plan" value="basic">
                    
                    <button type="submit" class="form-submit">Start gratis intake - Basic Coaching</button>
                    
                    <p style="text-align: center; color: rgba(255,255,255,0.5); margin-top: 1rem; font-size: 0.8rem;">
                        Door dit formulier in te vullen ga je akkoord met een gratis kennismakingsgesprek. Geen verplichtingen.
                    </p>
                </form>
            </div>
        </div>

        <div class="trajectory-right">
            <div class="trajectory-content">
                <div class="plan-switcher">
                    <button class="plan-option active" data-plan="basic">Basic</button>
                    <button class="plan-option" data-plan="pro">Pro</button>
                    <button class="plan-option" data-plan="elite">Elite</button>
                </div>

                <div style="display: flex; align-items: baseline; gap: 1.5rem; flex-wrap: wrap;">
                    <h1 class="trajectory-title" id="plan-title" style="margin: 0;">
                        <div class="title-line-container">
                            <span class="title-line">Basic Coaching</span>
                        </div>
                    </h1>
                    <div class="trajectory-price" id="plan-price">
                        <div class="price-text-container">
                            <span class="price-text">‚Ç¨297/maand</span>
                        </div>
                    </div>
                </div>

                <div class="trajectory-description" id="plan-description">
                    <!-- Description lines will be dynamically generated -->
                </div>

                <ul class="trajectory-features" id="plan-features">
                    <li>
                        <div class="li-text-container">
                            <span class="li-text">4 coaching sessies per maand</span>
                        </div>
                    </li>
                    <li>
                        <div class="li-text-container">
                            <span class="li-text">Persoonlijk actieplan</span>
                        </div>
                    </li>
                    <li>
                        <div class="li-text-container">
                            <span class="li-text">WhatsApp ondersteuning</span>
                        </div>
                    </li>
                    <li>
                        <div class="li-text-container">
                            <span class="li-text">Voortgangsrapportage</span>
                        </div>
                    </li>
                </ul>
            </div>
        </div>
    </div>

    <!-- Rocks Background -->
    <div class="trajectory-rocks"></div>

    <script>
        const planData = {
            basic: {
                title: 'Basic Coaching',
                description: 'Voor mensen die zelfstandig willen trainen, maar w√©l met professionele begeleiding om hun doelen te bereiken. Perfect om de juiste basis te leggen zonder overweldigende complexiteit.',
                features: [
                    'Persoonlijk trainingsschema (om de 4 weken aangepast)',
                    'Voedingsrichtlijnen & macrodoelen',
                    '1x per week check-in via whatsapp',
                    'Feedback en aanpassing waar nodig'
                ],
                price: '‚Ç¨89/maand'
            },
            pro: {
                title: 'Pro Coaching',
                description: 'Voor wie echt resultaten wil met intensieve persoonlijke opvolging. Dit pakket combineert de beste coaching tools met regelmatige evaluaties. Ideaal voor wie consistente progressie en professionele begeleiding wil.',
                features: [
                    'Alles uit Basic',
                    'Volledige online 1-op-1 coaching via PT Distinction app',
                    'Maandelijkse evaluatiecall',
                    'Voedingsschema + updates op basis van progressie',
                    'Toegang tot exclusieve Fitlike Coaching community'
                ],
                price: '‚Ç¨129/maand'
            },
            elite: {
                title: 'Elite Coaching',
                description: 'Jouw premium traject met maximale begeleiding en directe support. Het meest complete programma voor mensen die de beste versie van zichzelf willen worden. Holistische aanpak die verder gaat dan alleen fitness.',
                features: [
                    'Alles uit Pro',
                    'WhatsApp support (snelle feedback en motivatie)',
                    'Diepgaande levensstijlcoaching (slaap, stress, routines)',
                    'Wekelijkse evaluatiecalls of voice-updates',
                    'Prioriteit bij schema-updates'
                ],
                price: '‚Ç¨179/maand'
            }
        };

        document.querySelectorAll('.plan-option').forEach(button => {
            button.addEventListener('click', function() {
                // Remove active class from all buttons
                document.querySelectorAll('.plan-option').forEach(btn => btn.classList.remove('active'));
                
                // Add active class to clicked button
                this.classList.add('active');

                // Get selected plan
                const selectedPlan = this.dataset.plan;
                const planInfo = planData[selectedPlan];

                // Update the form's selected plan value
                document.getElementById('selectedPlan').value = selectedPlan;

                // Update submit button text to include plan name
                const submitButton = document.querySelector('.form-submit');
                submitButton.textContent = `Start gratis intake - ${planInfo.title}`;

                // Store the new content to update after exit animation
                window.pendingContentUpdate = {
                    title: planInfo.title,
                    description: planInfo.description,
                    price: planInfo.price,
                    features: planInfo.features,
                    selectedPlan: selectedPlan
                };

                // Trigger exit animation first
                if (window.animateTrajectoryContent) {
                    window.animateTrajectoryContent();
                }

                // Don't update content here - let the animation handle it
            });
        });

        // Check URL parameters and set initial plan
        document.addEventListener('DOMContentLoaded', function() {
            const urlParams = new URLSearchParams(window.location.search);
            const planFromUrl = urlParams.get('plan');
            const selectedPlan = (planFromUrl && planData[planFromUrl]) ? planFromUrl : 'basic';

            // Update content directly for the selected plan
            const planInfo = planData[selectedPlan];
            
            // Update title
            document.querySelector('#plan-title .title-line').textContent = planInfo.title;
            
            // Update description
            document.getElementById('plan-description').innerHTML = createDescriptionHTML(planInfo.description);
            
            // Update price
            document.querySelector('.price-text').textContent = planInfo.price;
            
            // Update features
            const featuresList = document.getElementById('plan-features');
            featuresList.innerHTML = '';
            planInfo.features.forEach(feature => {
                const li = document.createElement('li');
                li.innerHTML = `
                    <div class="li-text-container">
                        <span class="li-text">${feature}</span>
                    </div>
                `;
                featuresList.appendChild(li);
            });
            
            // Update selected plan value
            document.getElementById('selectedPlan').value = selectedPlan;
            
            // Update submit button
            const submitButton = document.querySelector('.form-submit');
            submitButton.textContent = `Start gratis intake - ${planInfo.title}`;
            
            // Set the correct button as active
            document.querySelectorAll('.plan-option').forEach(btn => {
                btn.classList.remove('active');
            });
            const targetButton = document.querySelector(`[data-plan="${selectedPlan}"]`);
            if (targetButton) {
                targetButton.classList.add('active');
            }
        });

        // EmailJS Configuration (same as main site)
        const EMAILJS_CONFIG = {
            PUBLIC_KEY: "8j_fJaV-chQQrmqOb",      // EmailJS public key
            SERVICE_ID: "service_v96yzmf",         // Hostinger SMTP service
            TEMPLATE_ID: "template_8r3s8jo"       // Coaching form template
        };

        // Initialize EmailJS when page loads
        document.addEventListener('DOMContentLoaded', function() {
            if (typeof emailjs !== 'undefined') {
                emailjs.init(EMAILJS_CONFIG.PUBLIC_KEY);
                console.log('EmailJS initialized successfully');
            } else {
                console.error('EmailJS library not loaded');
            }
        });

        // Form submission
        document.getElementById('trajectoryForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            // Get form data
            const formData = new FormData(this);
            const selectedPlan = document.getElementById('selectedPlan').value;
            const selectedPlanInfo = planData[selectedPlan];
            
            // Get submit button
            const submitBtn = document.querySelector('.form-submit');
            const originalText = submitBtn.textContent;
            
            // Show loading state
            submitBtn.textContent = 'Aanvraag wordt verstuurd...';
            submitBtn.disabled = true;
            
            try {
                // Check if EmailJS is available
                if (typeof emailjs === 'undefined') {
                    throw new Error('EmailJS not loaded');
                }
                
                // Prepare template parameters
                const templateParams = {
                    // Contact info
                    name: formData.get('name'),
                    email: formData.get('email'),
                    phone: formData.get('phone'),
                    age: formData.get('age'),
                    
                    // Plan details
                    plan: selectedPlanInfo.title,
                    price: selectedPlanInfo.price,
                    
                    // Form details
                    experience: formData.get('experience') || 'Niet opgegeven',
                    goals: formData.get('goals') || 'Niet opgegeven',
                    timeframe: formData.get('timeframe') || 'Niet opgegeven',
                    challenges: formData.get('challenges') || 'Niet opgegeven',
                    motivation: formData.get('motivation') || 'Niet opgegeven',
                    message: formData.get('message') || 'Geen extra informatie',
                    contact_preference: formData.get('contact-preference') || 'email'
                };
                
                console.log('Sending template params:', templateParams);
                
                // Send email via EmailJS
                const response = await emailjs.send(
                    EMAILJS_CONFIG.SERVICE_ID,
                    EMAILJS_CONFIG.TEMPLATE_ID,
                    templateParams
                );
                
                console.log('Email succesvol verstuurd!', response);
                
                // Show success
                submitBtn.textContent = '‚úì Aanvraag verstuurd! We nemen snel contact op.';
                submitBtn.style.backgroundColor = '#4CAF50';
                
                // Reset form after delay
                setTimeout(() => {
                    submitBtn.textContent = originalText;
                    submitBtn.style.backgroundColor = '';
                    submitBtn.disabled = false;
                    this.reset();
                    
                    // Reset to basic plan
                    document.querySelector('[data-plan="basic"]').click();
                }, 3000);
                
            } catch (error) {
                console.error('EmailJS Error:', error);
                submitBtn.textContent = 'Fout: Probeer opnieuw of bel ons';
                submitBtn.style.backgroundColor = '#ff4444';
                
                setTimeout(() => {
                    submitBtn.textContent = originalText;
                    submitBtn.style.backgroundColor = '';
                    submitBtn.disabled = false;
                }, 3000);
            }
        });
    </script>

    <!-- GSAP -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/ScrollTrigger.min.js"></script>
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/@emailjs/browser@3/dist/email.min.js"></script>
    
    <!-- Motivational Tab Messages -->
    <script>
        const motivationalMessages = [
            "üí™ Begin vandaag!",
            "üöÄ Niet uitstellen!",
            "üéØ Doelen halen?",
            "üî• Fit worden?",
            "‚è∞ Nu is het moment!",
            "üíØ Jij kan dit!",
            "üèÜ Start je transformatie",
            "‚ö° Geen excuses meer",
            "üéæ Actie = Resultaat",
            "üí• Waarom wachten?",
            "üåü Jouw tijd is nu",
            "üèÉ Eerste stap zetten?",
            "üíé Investeer in jezelf",
            "üî• Ready to transform?",
            "‚≠ê Maak het waar!",
            "üö® Stop met uitstellen",
            "üí™ Sterker worden?",
            "üéØ Focus op je doel",
            "‚è±Ô∏è Tijd vliegt...",
            "üèãÔ∏è Klaar voor verandering?"
        ];

        let originalTitle = document.title;
        let titleInterval;

        function showMotivationalMessage() {
            const randomMessage = motivationalMessages[Math.floor(Math.random() * motivationalMessages.length)];
            document.title = randomMessage;
        }

        function startTitleAnimation() {
            if (titleInterval) clearInterval(titleInterval);
            showMotivationalMessage();
            titleInterval = setInterval(showMotivationalMessage, 3000);
        }

        function restoreTitle() {
            if (titleInterval) {
                clearInterval(titleInterval);
                titleInterval = null;
            }
            document.title = originalTitle;
        }

        // Set up when DOM loads
        document.addEventListener('DOMContentLoaded', function() {
            originalTitle = document.title;
            
            document.addEventListener('visibilitychange', function() {
                if (document.hidden) {
                    startTitleAnimation();
                } else {
                    restoreTitle();
                }
            });
            
            window.addEventListener('blur', function() {
                startTitleAnimation();
            });
            
            window.addEventListener('focus', function() {
                restoreTitle();
            });
        });
    </script>

    <!-- Navigation Scroll Trigger Script -->
    <script>
        // Initialize navigation scroll trigger for trajectory page
        function initNavigationScrollTrigger() {
            const navbarTop = document.querySelector('.navbar');

            if (navbarTop) {
                // Initially hide navbar
                navbarTop.classList.add('hidden');

                let ticking = false;

                function updateNavbar() {
                    const scrollY = window.scrollY;

                    // Top navbar: Show only when at very top (within 50px)
                    if (scrollY <= 50) {
                        navbarTop.classList.remove('hidden');
                    } else {
                        navbarTop.classList.add('hidden');
                    }

                    ticking = false;
                }

                function requestTick() {
                    if (!ticking) {
                        requestAnimationFrame(updateNavbar);
                        ticking = true;
                    }
                }

                window.addEventListener('scroll', requestTick);
                window.addEventListener('resize', requestTick);

                // Check initial position
                updateNavbar();
            }
        }

        // Initialize navigation on page load
        document.addEventListener('DOMContentLoaded', initNavigationScrollTrigger);

        // Function to split text into lines based on character count
        function splitDescriptionIntoLines(text, maxCharsPerLine = 90) {
            const words = text.split(' ');
            const lines = [];
            let currentLine = '';

            for (const word of words) {
                if ((currentLine + word).length <= maxCharsPerLine) {
                    currentLine += (currentLine ? ' ' : '') + word;
                } else {
                    if (currentLine) lines.push(currentLine);
                    currentLine = word;
                }
            }
            if (currentLine) lines.push(currentLine);
            return lines;
        }

        // Function to create description HTML with line containers
        function createDescriptionHTML(description) {
            const lines = splitDescriptionIntoLines(description);
            return lines.map(line => `
                <div class="desc-line-container">
                    <span class="desc-line">${line}</span>
                </div>
            `).join('');
        }

        // Initialize trajectory animations
        function initTrajectoryAnimations() {
            gsap.registerPlugin(ScrollTrigger);

            // Title stagger animation function (same as index page)
            function createTitleStaggerAnimation(selector) {
                const titleLines = document.querySelectorAll(`${selector} .title-line`);
                if (titleLines.length === 0) return null;

                const titleTimeline = gsap.timeline({ paused: true });
                gsap.set(titleLines, { y: "130%" });

                titleLines.forEach((line, index) => {
                    titleTimeline.to(line, {
                        y: "10%",
                        duration: 1.0,
                        ease: "power3.out"
                    }, index * 0.25);
                });

                return titleTimeline;
            }

            // Reset initial states to make everything visible
            function resetInitialStates() {
                // Make title visible
                const titleLines = document.querySelectorAll('.trajectory-title .title-line');
                gsap.set(titleLines, { y: "0%" });

                // Make description lines visible
                const descriptionLines = document.querySelectorAll('.desc-line');
                gsap.set(descriptionLines, { y: "0%" });

                // Make features visible and show lines
                const textElements = document.querySelectorAll('.trajectory-features .li-text');
                const items = document.querySelectorAll('.trajectory-features li');

                gsap.set(textElements, { y: "0%" });
                items.forEach(item => item.style.setProperty('--line-scale', '1'));

                // Make price visible
                const priceText = document.querySelector('.price-text');
                if (priceText) {
                    gsap.set(priceText, { y: "0%" });
                }
            }

            // Call reset function when page loads
            setTimeout(resetInitialStates, 100);

            // Simple content update without animations
            window.animateTrajectoryContent = function() {
                const update = window.pendingContentUpdate;
                if (update) {
                    const titleElement = document.querySelector('#plan-title .title-line');
                    if (titleElement) {
                        titleElement.textContent = update.title;
                    }
                    document.getElementById('plan-description').innerHTML = createDescriptionHTML(update.description);
                    document.querySelector('.price-text').textContent = update.price;
                    document.getElementById('selectedPlan').value = update.selectedPlan;

                    // Update features list
                    const featuresList = document.getElementById('plan-features');
                    featuresList.innerHTML = '';
                    update.features.forEach(feature => {
                        const li = document.createElement('li');
                        li.innerHTML = `
                            <div class="li-text-container">
                                <span class="li-text">${feature}</span>
                            </div>
                        `;
                        featuresList.appendChild(li);
                    });

                    window.pendingContentUpdate = null;

                    // Reset states after content update to make everything visible
                    setTimeout(() => {
                        resetInitialStates();
                    }, 50);
                }
            };
        }

        // Initialize animations on page load
        document.addEventListener('DOMContentLoaded', initTrajectoryAnimations);
    </script>

    <!-- Page Transition Script -->
    <script>
        // Page transition for trajectory page
        const $frameOrange = document.querySelector('.page-transition__orange');
        const $frameBlack = document.querySelector('.page-transition__black');

        if ($frameOrange && $frameBlack) {
            // Handle navigation links (including the "Terug" link)
            const navLinks = document.querySelectorAll('a[href="../"]');
            navLinks.forEach(link => {
                link.addEventListener('click', (e) => {
                    e.preventDefault();
                    const href = link.getAttribute('href');

                    // Create enter animation (top to bottom)
                    const tlEnter = gsap.timeline()
                        .fromTo($frameOrange, {
                            scaleY: 0
                        }, {
                            scaleY: 1,
                            transformOrigin: 'top',
                            duration: 0.9,
                            ease: 'power4.inOut'
                        })
                        .fromTo($frameBlack, {
                            scaleY: 0
                        }, {
                            scaleY: 1,
                            transformOrigin: 'top',
                            duration: 0.9,
                            ease: 'power4.inOut'
                        }, 0.1);

                    // Navigate when black screen is fully visible
                    setTimeout(() => {
                        sessionStorage.setItem('pageTransitionActive', 'true');
                        window.location.href = href;
                    }, 1100);
                });
            });

            // Always play page load animation (on every refresh or page visit)
            // Start with frames fully covering screen at bottom position
            gsap.set($frameOrange, { yPercent: 0, scaleY: 1 });
            gsap.set($frameBlack, { yPercent: 0, scaleY: 1 });

            // GSAP animation - slides up from bottom to top
            gsap.timeline({ delay: 0.3 })
                .to($frameBlack, {
                    yPercent: -100,
                    duration: 0.8,
                    ease: 'power2.inOut'
                })
                .to($frameOrange, {
                    yPercent: -100,
                    duration: 0.8,
                    ease: 'power2.inOut'
                }, 0.1)
                .call(() => {
                    // Reset frames for next transition
                    gsap.set($frameOrange, { yPercent: 0, scaleY: 0 });
                    gsap.set($frameBlack, { yPercent: 0, scaleY: 0 });
                });

            // Clean up session storage if it exists
            if (sessionStorage.getItem('pageTransitionActive')) {
                sessionStorage.removeItem('pageTransitionActive');
            }
        }
    </script>
</body>
</html>